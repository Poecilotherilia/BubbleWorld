---
--- Generated by wuhaijun
--- File name : hashset.lua.txt
--- DateTime : 2021/03/29
--- Description : hashset
---

---@class hashset
local hashset = {}
hashset.__index = hashset

---@public
---@return hashset
function hashset.new(is_weak)
    local instance = {
        cname = "hashset",
        ---@private
        set = {},
        ---@private
        size = 0,
    }
    if is_weak then
        setmetatable(instance, { __mode = "v" })
    end
    return setmetatable(instance, hashset)
end

---添加元素
---@public
---@return boolean
---@param key any key
---@param value any value
function hashset:add(key, value)
    if key == nil then
        return false
    end

    if self.set[key] == nil then
        self.set[key] = value or true
        self.size = self.size + 1
        return true
    end
    return false
end

---移除key
---@public
---@return boolean
---@param key any key
function hashset:remove(key)
    if key == nil then
        return false
    end

    if self.set[key] ~= nil then
        self.set[key] = nil
        self.size = self.size - 1
        return true
    end

    return false
end

---是否包含key
---@public
---@return boolean
---@param key any key
function hashset:contains(key)
    return self.set[key] ~= nil
end

---包含对象数量
---@public
---@return number
function hashset:count()
    return self.size
end

---是否为空
---@public
---@return boolean
function hashset:is_empty()
    return self:count() == 0
end

---遍历
---@public
---@param action function 遍历function(k,v)
function hashset:foreach(action, ...)
    if action == nil then
        return
    end

    for k, v in pairs(self.set) do
        if v then
            action(k, v, ...)
        end
    end
end

---清理
---@public
function hashset:clear()
    for k, _ in pairs(self.set) do
        self.set[k] = nil
    end
    self.size = 0
end

---销毁
---@public
function hashset:dispose()
    self:clear()
    self.set = nil
    self.size = nil
end

return hashset