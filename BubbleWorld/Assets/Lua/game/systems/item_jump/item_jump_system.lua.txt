---
--- Generated by panzhiyuan
--- File name : item_jump_system.lua.txt
--- DateTime : 2023/04/17
--- Description : 道具获取途径跳转系统
---

local explore_data = game_data_manager.explore
local item_type = enum.item.item_source_type
local window = window
local tables = tables
local data = data
local message = message
local message_type = enum.message_type
---@class item_jump_system
local item_jump_system = class("item_jump_system")

---构造函数
---@private
function item_jump_system:ctor()
    self.target_window_id = nil
    self.jump_type = item_type.Explore
    self.is_jump = false
    self.item_id = nil
    self.home_scene_id = data.get(tables.ConstClient.name, tables.ConstClient.ids.KW_SCENE_HOME).String
    self:add_listener()
end

function item_jump_system:add_listener()
    message.add_listener(message_type.ITEM_SET_JUMP_STATE, self.on_set_jump_state, self)
end

function item_jump_system:remove_listener()
    message.remove_listener(message_type.ITEM_SET_JUMP_STATE, self.on_set_jump_state, self)
end

function item_jump_system:on_set_jump_state(is_jump)
    self.is_jump = is_jump
end

function item_jump_system:get_is_jump()
    return self.is_jump
end

function item_jump_system:jump_to_explore_level(node_id)
    self.node_id = node_id
    ---@type explore_node_data
    local node_data = explore_data:get_explore_node_data_by_id(node_id)
    if nil == node_data then
        return
    end
    system_manager.explore.last_chapter_id = node_data.map.Id
    local param = {}
    param.type = node_data.node.EventType
    param.node = node_data
    param.node_id = node_id
    param.is_jump_come = true
    window.open(tables.Window.ids.ExploreNodeEvent, param)
end

function item_jump_system:dispose()
    self:remove_listener()
end


return item_jump_system