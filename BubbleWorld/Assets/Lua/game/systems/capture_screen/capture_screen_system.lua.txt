---
--- Generated by lvyuqiang
--- File name : capture_screen.lua.txt
--- DateTime : 2023/08/21
--- Description : 
---

---@class capture_screen
local capture_screen_system = class("capture_screen_system")
local window = window
local w_status = df.enum.window_status
local t = tables
local lua = lua
---构造函数
---@private
function capture_screen_system:ctor()
    
end

---开始截屏
---@public
function capture_screen_system:start(callback)
    local w = window.open(t.Window.ids.CaptureScreen)
    lua.wait_until_async(function()
        return w.status == w_status.show and w.view_model.is_screen_ok
    end, function()
        self.screen_sprite = w.view_model.screen_sprite
        if callback then
            callback()
        end
    end)
end

---获取当前截屏
---@public
function capture_screen_system:get_current_sprite()
    return self.screen_sprite
end

---获取当前截屏尺寸
---@public
function capture_screen_system:close_window()
    local w = window.get_window(t.Window.ids.CaptureScreen)
    if w then
        window.close(w, true)
    end

    self.screen_sprite = nil
end 

return capture_screen_system