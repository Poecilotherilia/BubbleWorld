---
--- Generated by wuhaijun
--- File name : behavior_look_at_target.lua.txt
--- DateTime : 2021/11/29
--- Description : 行为目标看向某个目标。
---

---@type battle_helper
local helper = battle_helper
local behavior_target_type = enum.battle.behavior_target_type

---@type vector3
local vector3 = require(helper.path.battle_utils ..  'vector3')
---@type quaternion
local quaternion = require(helper.path.battle_utils ..  'quaternion')
---@type battle_components
local battle_components = require(helper.path.battle_components)
---@type base_behavior
local super = require(helper.path.battle_skill .. 'behavior/base_behavior')

---@class behavior_look_at_target : base_behavior
local behavior_look_at_target = class("behavior_look_at_target", super)

---构造函数
---@protected
function behavior_look_at_target:ctor()
    super.ctor(self, self.cname)
end

---行为开始，根据配置延迟后开始
---@protected
function behavior_look_at_target:on_start()
    ---@type look_at_target_data
    local config_data = self.behavior_data.behavior_args.LookAtTargetData
    self:log_assert(config_data ~= nil, "invalid LookAtTargetData")

    ---@type number 持续时间
    local time = self.behavior_data.duration_time
    
    -- 获取行为目标列表
    ---@type number[][]
    local target_list = self:get_behavior_targets(config_data.TargetId, config_data.TargetArgs)
    ---@type number[] 目标位置
    local pos = target_list[1]
    
    local current_entity = self:get_current_entity()
    current_entity:replace_component(battle_components.visual_follow, pos[1], pos[2], pos[3], time)
end

return behavior_look_at_target