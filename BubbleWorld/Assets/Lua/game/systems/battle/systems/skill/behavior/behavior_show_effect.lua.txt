---
--- Generated by wuhaijun
--- File name : behavior_show_effect.lua.txt
--- DateTime : 2021/11/09
--- Description : 在“行为目标”的挂点上播放特效
---

---@type battle_helper
local helper = battle_helper
local is_nil_or_empty = string.is_nil_or_empty

---@type battle_utility
local battle_utility = require(helper.path.battle_utils .. 'battle_utility')
---@type base_behavior
local super = require(helper.path.battle_skill .. 'behavior/base_behavior')

---@class behavior_show_effect : base_behavior
local behavior_show_effect = class("behavior_show_effect", super)

---构造函数
---@protected
function behavior_show_effect:ctor()
    super.ctor(self, self.cname)
end

---行为开始，根据配置延迟后开始
---@protected
function behavior_show_effect:on_start()
    ---@type show_effect_data
    local data = self.behavior_data.behavior_args.ShowEffectData
    self:log_assert(data ~= nil, "invalid ShowEffectData")
    
    ---@type string 特效配置
    local effect_mid = data.EffectId
    if is_nil_or_empty(effect_mid) or effect_mid == '-1' then
        return
    end
    
    ---@type boolean 是否成为子节点,0=特效在挂点下生成，1=挂点在根节点下生成（只取挂点的位置）
    local is_sub_obj = data.IsSubObj == 0
    ---@type number, number, number 偏移
    local xx, yy, zz = data.Offset.X, data.Offset.Y, data.Offset.Z

    battle_utility.show_effect(self.context, self:get_current_entity(), effect_mid, is_sub_obj, xx, yy, zz)
end

return behavior_show_effect