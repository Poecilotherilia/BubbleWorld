---
--- Generated by wuhaijun
--- File name : fsm_battle_factory.lua.txt
--- DateTime : 2023/06/01
--- Description : 
---

local helper = battle_helper
local table_names = tables

---@class fsm_battle_factory
local fsm_battle_factory = { cname = "fsm_battle_factory" }

---战斗状态集合
---@private
---@type table<string, fsm_battle_base>
local battle_fsm_dict

---初始化
---@public
---@param context context
function fsm_battle_factory.init(context)
    if battle_fsm_dict ~= nil then return end
    
    local state_ids = table_names.BTLState.ids
    local battle_fsm_path = helper.path.battle_fsm
    battle_fsm_dict =
    {
        [state_ids.BTLState_Idle] = require(battle_fsm_path .. 'fsm/battle_fsm_idle').new(context),
        [state_ids.BTLState_Born] = require(battle_fsm_path .. 'fsm/battle_fsm_born').new(context),
        [state_ids.BTLState_BeHit] = require(battle_fsm_path .. 'fsm/battle_fsm_be_hit').new(context),
        [state_ids.BTLState_Skill] = require(battle_fsm_path .. 'fsm/battle_fsm_skill').new(context),
        [state_ids.BTLState_Dizzy] = require(battle_fsm_path .. 'fsm/battle_fsm_dizzy').new(context),
        [state_ids.BTLState_Death] = require(battle_fsm_path .. 'fsm/battle_fsm_death').new(context),
        [state_ids.BTLState_Revive] = require(battle_fsm_path .. 'fsm/battle_fsm_revive').new(context),
    }
end

---获取状态
---@public
---@param mid string
function fsm_battle_factory.get_fsm(mid)
    return battle_fsm_dict[mid]
end

---销毁
---@public
function fsm_battle_factory.dispose()
    for _, fsm in pairs(battle_fsm_dict) do
        fsm:dispose()
    end
    battle_fsm_dict = nil
end

return fsm_battle_factory