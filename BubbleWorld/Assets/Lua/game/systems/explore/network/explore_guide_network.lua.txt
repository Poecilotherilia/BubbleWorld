---
--- Generated by libin
--- File name : explore_guide_network.lua.txt
--- DataTime : 2023/02/27
--- Description : 探索引导者网络协议
---

local message = message
---@type message_type
local message_type = enum.message_type
local net_mgr = network
local message_names = message_names
local enum_proto = enum.proto
local EGameMsgID = enum_proto.EGameMsgID
local EGameEventCode = enum_proto.EGameEventCode
local tables = tables
local window = window

---@class explore_guide_network
local explore_guide_network = class("explore_guide_network")

--region base api

---构造方法
---@protected
function explore_guide_network:ctor()
    self:add_listener()
end

---@public
function explore_guide_network:dispose()
    self:remove_listener()
end



--endregion

--region listener

function explore_guide_network:add_listener()
    net_mgr.add_message_listener(EGameMsgID.ACK_GET_SHOP_PRODUCTS, message_names.AckGetShopProducts, self.on_ack_get_shop_products, self)
    net_mgr.add_message_listener(EGameMsgID.ACK_BUY_PRODUCT, message_names.AckBuyProduct, self.on_ack_buy_product, self)
    net_mgr.add_message_listener(EGameMsgID.ACK_UPGRADE_EXPLORE_GUIDER_FRIENDSHIP, message_names.AckUpgradeExploreGuiderFriendship, self.on_ack_upgrade_explore_guider_friend_ship, self)
end

function explore_guide_network:remove_listener()
    net_mgr.remove_message_listener(EGameMsgID.ACK_GET_SHOP_PRODUCTS, self.on_ack_get_shop_products, self)
    net_mgr.remove_message_listener(EGameMsgID.ACK_BUY_PRODUCT, self.on_ack_buy_product, self)
    net_mgr.remove_message_listener(EGameMsgID.ACK_UPGRADE_EXPLORE_GUIDER_FRIENDSHIP, self.on_ack_upgrade_explore_guider_friend_ship, self)
end

--endregion

--region ack

---指引者友好度回复
---@public
---@param ack_info AckUpgradeExploreGuiderFriendship
function explore_guide_network:on_ack_upgrade_explore_guider_friend_ship(ack_info)
    if ack_info.event_code == EGameEventCode.SUCCESS then
        --TODO 刷新路点
        system_manager.explore:update_guide_info()
    end
end

---商城数据回复
---@public
---@param ack_info AckGetShopProducts
function explore_guide_network:on_ack_get_shop_products(ack_info)
    if ack_info.event_code == EGameEventCode.SUCCESS then
        game_data_manager.explore_guide:on_ack_get_shop_products(ack_info)
    end
end

---购买回复
---@public
---@param ack_info AckBuyProduct
function explore_guide_network:on_ack_buy_product(ack_info)
    if ack_info.event_code == EGameEventCode.SUCCESS then
        game_data_manager.explore_guide:on_ack_buy_product(ack_info)
    end
end

--endregion

--region req

---请求指引者商店数据
---@public
---@param shop_id string
function explore_guide_network:req_get_shop_products(shop_id)
    ---@type ReqGetShopProducts
    local req = {}
    req.player_id = game_data_manager.player.player_net_obj:get_id()
    req.shop_id = shop_id

    net_mgr.send_message_async(EGameMsgID.REQ_GET_SHOP_PRODUCTS, message_names.ReqGetShopProducts, req)
end

---引导者友好度升级
---@public
---@param guide_id string
function explore_guide_network:req_upgrade_explore_guider_friend_ship(guide_id)
    ---@type ReqUpgradeExploreGuiderFriendship
    local req = {}
    req.player_id = game_data_manager.player.player_net_obj:get_id()
    req.explore_guider_id = guide_id

    net_mgr.send_message_async(EGameMsgID.REQ_UPGRADE_EXPLORE_GUIDER_FRIENDSHIP, message_names.ReqUpgradeExploreGuiderFriendship, req)
end

--endregion

return explore_guide_network


