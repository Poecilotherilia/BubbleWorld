---
--- Generated by libin
--- File name : explore_dungeon_node_render_unit.lua.txt
--- DataTime : 2023/03/14
--- Description : 探索节点渲染器-材料副本
---


local Color = cs.Color
local data = data
local tables = tables

local super = require "game/systems/explore/node/explore_node_render_unit"

---@class explore_dungeon_node_render_unit : explore_node_render_unit
local explore_dungeon_node_render_unit = class("explore_dungeon_node_render_unit", super)

--region base api

---构造方法
---@protected
---@param cs_node_unit Game.Explore.ExploreNodeUnit
---@param node_data explore_node_data
function explore_dungeon_node_render_unit:ctor(cs_node_unit, node_data)

    ---@type boolean
    self.is_lock = nil
    ---@type UnityEngine.Color
    self.node_icon_color = nil
    ---@type string
    self.node_name = nil
    ---@type boolean
    self.is_box_1_lock = nil
    ---@type boolean
    self.is_box_2_lock = nil
    ---@type boolean
    self.is_box_3_lock = nil
    ---@type boolean
    self.is_box_4_lock = nil
    ---@type boolean
    self.is_box_5_lock = nil

    self.effect_id = nil

    super.ctor(self, cs_node_unit, node_data)
end

---@public
function explore_dungeon_node_render_unit:dispose()
    super.dispose(self)
    self.is_lock = nil
    self.node_icon_color = nil
    self.node_name = nil
    self.is_box_1_lock = nil
    self.is_box_2_lock = nil
    self.is_box_3_lock = nil
    self.is_box_4_lock = nil
    self.is_box_5_lock = nil

    if nil ~= self.effect_id then
        effect.manual_unload_effect(self.effect_id)
        self.effect_id = nil
    end

end

---初始化绑定器
---@protected override
function explore_dungeon_node_render_unit:init_binding()
    super.init_binding(self)
    self:create_simple_property("is_lock", false, true)
    self:create_simple_property("node_icon_color", nil, true)
    self:create_simple_property("node_name", "nil", true)
    self:create_simple_property("is_box_1_lock", false, true)
    self:create_simple_property("is_box_2_lock", false, true)
    self:create_simple_property("is_box_3_lock", false, true)
    self:create_simple_property("is_box_4_lock", false, true)
    self:create_simple_property("is_box_5_lock", false, true)
end

---获得CS传入的游戏对象上挂载的脚本
---@protected override
function explore_dungeon_node_render_unit:init_component()

end

--endregion

--region logic

---显示列表元素
---@protected override
function explore_dungeon_node_render_unit:show_item()
    --super.show_item(self)
    
    self.node_icon = self.node_data.node.NodeIcon
    --主线最新路点判断
    self:update_arrived_stata()

    self.node_name = self.node_data.node.NodeName

    local remain_count =  game_data_manager.explore_dungeon:get_daily_remain_count(self.node_data.node.EventParam)
    if remain_count == 0 then
        self.is_box_1_lock = false
        self.is_box_2_lock = false
        self.is_box_3_lock = false
        self.is_box_4_lock = false
        self.is_box_5_lock = false
    elseif remain_count == 1 then
        self.is_box_1_lock = false
        self.is_box_2_lock = false
        self.is_box_3_lock = false
        self.is_box_4_lock = false
        self.is_box_5_lock = true
    elseif remain_count == 2 then
        self.is_box_1_lock = false
        self.is_box_2_lock = false
        self.is_box_3_lock = false
        self.is_box_4_lock = true
        self.is_box_5_lock = true
    elseif remain_count == 3 then
        self.is_box_1_lock = false
        self.is_box_2_lock = false
        self.is_box_3_lock = true
        self.is_box_4_lock = true
        self.is_box_5_lock = true
    elseif remain_count == 4 then
        self.is_box_1_lock = false
        self.is_box_2_lock = true
        self.is_box_3_lock = true
        self.is_box_4_lock = true
        self.is_box_5_lock = true
    elseif remain_count == 5 then
        self.is_box_1_lock = true
        self.is_box_2_lock = true
        self.is_box_3_lock = true
        self.is_box_4_lock = true
        self.is_box_5_lock = true
    end
end

---设置节点显/隐
---@protected override
---@param is_active boolean
function explore_dungeon_node_render_unit:set_active(is_active)
    self.cs_unit:SetActive(is_active)
    if self.node_data.state <= 0 then
        self.is_lock = true
        self.node_icon_color = Color(132/255, 132/255, 132/255)
    else
        self.is_lock = false
        self.node_icon_color = Color.white
    end
end

---@public
function explore_dungeon_node_render_unit:play_active_effect()
    if not string.is_nil_or_empty(self.node_data.node.Effect) then
        self.effect_id = effect.play_effect_async(self.node_data.node.Effect, self.obj, 1)
    end
end

---刷新到达状态
---@public
function explore_dungeon_node_render_unit:update_arrived_stata()

end

--endregion


return explore_dungeon_node_render_unit