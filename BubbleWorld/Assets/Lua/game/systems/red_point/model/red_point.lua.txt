---
--- Generated by lvyuqiang
--- File name : red_point.lua.txt
--- DateTime : 2023/07/28
--- Description : 红点 
---

---@class red_point
local red_point = class("red_point")
local array_table = array_table
local mrp = cs.RedPoint

---构造函数
---@private
function red_point:ctor()
    ---@type string
    self.id = nil
    ---@type red_point
    self.parent = nil
    ---@type table<red_point>
    self.children = nil
    ---@type boolean
    self.visible = false
end

---添加子节点
---@param rp red_point
---@public
function red_point:add_child(rp)
    if self.children == nil then
        self.children = {}
    end
    array_table.insert(self.children, rp)
end

---设置红点是否可见
---@public
function red_point:set_visible(visible)
    if self.visible ~= visible then
        self.visible = visible
        mrp.UpdateRedPoint(self.id, visible)
        ---父节点刷新
        if self.parent then
            self.parent:refresh_by_children()
        end
    end
end

---根据子节点状态刷新
---@private
function red_point:refresh_by_children()
    local visible = false
    for i = 1, #self.children do
        if self.children[i].visible then
            visible = true
            break
        end
    end
    self:set_visible(visible)
end

return red_point