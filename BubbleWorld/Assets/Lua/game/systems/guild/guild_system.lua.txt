---
--- Generated by pan zhi yuan
--- File name : guild_system.lua.txt
--- DateTime : 2023/10/31
--- Description :
---

local LuaUtil = cs.LuaUtil
local TweenUtil = cs.TweenUtil
local Ease = cs.Ease
local camera_manager = camera_manager
local message = message
local data = data
local guild_controller = require"game/systems/guild/guild_controller"
local protagonist_system = system_manager.protagonist
local tables = tables
local enum = enum
local message_type = enum.message_type
local camera_position_type = enum.protagonist.camera_position_type
local hero_manager = require 'game/hero/hero_manager'
---@class guild_system
local guild_system = class("guild_system", super)

---构造函数
---@protected
function guild_system:ctor()
    ---@type guild_controller
    self.guild_pve_controller = nil
end

function guild_system:init_controller()
    self.guild_pve_controller = guild_controller.new(nil, "guild_pve_vm")
    
end

function guild_system:on_show()
    if self.guild_pve_controller then
        self.guild_pve_controller:on_show()
    else
        self:init_controller()
        self.guild_pve_controller:on_show()
    end
    --protagonist_system:set_protagonist_hero_camera_active(false)
end

function guild_system:zoom_in_camera(callback)
    self.guild_pve_controller:zoom_in_camera(callback)
end

function guild_system:zoom_out_camera(callback)
    self.guild_pve_controller:zoom_out_camera(callback)
end

function guild_system:get_effect_root()
    self.guild_pve_controller:get_effect_root()
end

function guild_system:init_camera_state()
    self.guild_pve_controller:show_virtual_camera(nil, 0.1)
end

function guild_system:on_hide()
    --self.guild_pve_controller:hide_virtual_camera()
    self.guild_pve_controller:revert_camera()
    if self.guild_pve_controller then
        self.guild_pve_controller:clear_camera()
    end
    self.guild_pve_controller:unload_sync()
    --protagonist_system:set_protagonist_hero_camera_active(true)
    self:unload_pve_controller()
    
end

function guild_system:preload_role_res_sync(monster_id)
    return self.guild_pve_controller:preload_sync(monster_id, nil)
end

function guild_system:hide_last_role()
    self.guild_pve_controller:hide_role()
end

---控制播放待机动作
---@public
function guild_system:play_idle_action()
    if self.guild_pve_controller then
        local callback = function()
            self:play_idle_action()
        end
        self.guild_pve_controller:play_idle_action(callback)
    end
end

---清理角色控制器
---@public
function guild_system:unload_pve_controller()
    if self.guild_pve_controller then
        self.guild_pve_controller:dispose()
        self.guild_pve_controller = nil
    end
end

function guild_system:dispose()
    self:remove_listener()
    if self.guild_pve_controller then
        self.guild_pve_controller:dispose()
        self.guild_pve_controller = nil
    end
end

return guild_system